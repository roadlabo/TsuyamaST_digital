# 津山駅サイネージ
# 産業用PC セットアップマニュアル【完全初心者対応・超詳細版】

## はじめに（重要）
このマニュアルは、
**パソコンに詳しくない人が、上から順にそのまま操作するだけでサイネージを動かせること** を目的に書いています。

意味が分からなくても、**書いてある通りにクリック** してください。

---

## 作業全体の流れ（先に全体像）
1. USBを挿してフォルダをコピーする
2. 画面が勝手に消えないように設定する
3. ネットワーク制限（Windowsファイアーウォール）を解除する
4. 電源ONで自動起動するように設定する
5. 壁紙にサイネージ番号を表示する
6. ディスプレイの向きを確認・調整する
7. IPアドレスを番号に合わせて固定する
8. ログインパスワードを不要にする（自動ログイン）
9. 再起動して、勝手に動画が出るか確認する

---

## ① USBからフォルダをコピーする（最重要）

### ①-1 USBを挿す
産業用PCのUSB差込口に、**セットアップ用USBメモリ**を挿してください。

### ①-2 USBを開く
1. 画面左下の **Windowsマーク（スタートボタン）** をクリック
2. 表示されたメニューの中から **「エクスプローラー」** をクリック
   - 黄色いフォルダのアイコンです

### ①-3 `_TsuyamaSignage` をコピー
1. 左側の一覧から **「USBドライブ（E:）」** をクリック
   - **E:** 以外の文字でもOK（「USB」と書いてあるもの）
2. 右側に **「_TsuyamaSignage」** というフォルダが見えることを確認
3. **_TsuyamaSignage** を右クリック
4. 表示されたメニューから **「コピー」** をクリック

### ①-4 Cドライブに貼り付け
1. 左側の一覧から **「ローカル ディスク（C:）」** をクリック
2. 右側の白い何もないところで **右クリック**
3. 表示されたメニューから **「貼り付け」** をクリック
4. コピーが終わるまで待つ（数十秒〜数分）

### ①-5 確認
以下の場所にフォルダがあれば成功です。

```
C:\_TsuyamaSignage
```

**⚠ 注意**
- フォルダ名を変えない
- **C:\ の直下** にあることが重要

---

## ② 画面が勝手に消えない設定（必須）

### ②-1 設定画面を開く
1. 画面左下の **Windowsマーク** をクリック
2. **歯車マーク（設定）** をクリック

### ②-2 電源設定を開く
1. 左側メニューから **「システム」** をクリック
2. 右側を下にスクロール
3. **「電源とバッテリー」** をクリック

### ②-3 スリープを無効にする
1. **「画面とスリープ」** という項目を探す
2. 次の項目をすべて **「なし」** に変更する
   - 画面をオフにする → なし
   - スリープ状態にする → なし
3. プルダウンをクリックして **「なし」** を選ぶ

---

## ③ WindowsファイアーウォールをOFFにする

### ③-1 セキュリティ設定を開く
1. **Windowsマーク** をクリック
2. キーボードで **「Windows セキュリティ」** と入力
3. 表示された **「Windows セキュリティ」** をクリック

### ③-2 ファイアーウォール画面を開く
1. 左側メニューから **「ファイアーウォールとネットワーク保護」** をクリック

### ③-3 3つともOFFにする

#### ① ドメインネットワーク
1. **「ドメインネットワーク」** をクリック
2. **「Microsoft Defender ファイアーウォール」** を **オフ** にする
3. 左上の **←** をクリックして戻る

#### ② プライベートネットワーク
1. **「プライベートネットワーク」** をクリック
2. **「Microsoft Defender ファイアーウォール」** を **オフ** にする
3. 左上の **←** をクリックして戻る

#### ③ パブリックネットワーク
1. **「パブリックネットワーク」** をクリック
2. **「Microsoft Defender ファイアーウォール」** を **オフ** にする
3. 左上の **←** をクリックして戻る

### ③-4 確認
3つすべてに **「ファイアーウォールはオフです」** と表示されていればOK

---

## ④ 電源ONで自動起動する設定（必須）

### ④-1 タスクスケジューラを開く
1. **Windowsマーク** をクリック
2. キーボードで **「タスク スケジューラ」** と入力
3. **「タスク スケジューラ」** をクリック

### ④-2 新しいタスクを作成
1. 右側の **「タスクの作成」** をクリック

### ④-3 全般タブ
1. **名前** に次を入力
   - `TsuyamaSignage Auto Start`
2. **「ユーザーがログオンしているときのみ実行する」** を選択
3. **「最上位の特権で実行する」** にチェック
4. **「ユーザーまたはグループの変更」** をクリック
5. **ユーザー名** に **SystemAV** を入力 → **名前の確認** → **OK**

### ④-4 トリガータブ
1. **「新規」** をクリック
2. **開始：** から **「ログオン時」** を選ぶ
3. **ユーザー：** **SystemAV** を選ぶ
4. **「遅延時間」** を **30秒** に設定
5. **OK** をクリック

**⚠ 重要（必ず守る）**
- 起動直後はOSの初期化が終わっておらず、**30秒遅延** を入れることで正常に発火します。

### ④-5 操作タブ
1. **「新規」** をクリック
2. **プログラム/スクリプト：** に次を入力

```
C:\_TsuyamaSignage\start_signage.bat
```

3. **OK** をクリック

### ④-6 保存
1. **OK** をクリックして閉じる

---

## ⑤ 壁紙にサイネージ番号を表示する（必須）

### ⑤-1 目的
現地で **「この画面が何番のサイネージか」** をすぐ判別できるようにします。

**重要ルール**
- **壁紙の番号＝IPアドレスの下2桁** を必ず一致させる

### ⑤-2 壁紙のルール（運用）
- USB内の **壁紙フォルダ** に、サイネージ番号 **01〜20** の画像がある
- 設置するPCの番号に対応した画像を壁紙に設定する

### ⑤-3 設定手順（GUI操作）
1. デスクトップの何もないところで **右クリック**
2. **「個人用設定」** をクリック
3. 左メニューから **「背景」** をクリック
4. **「背景をカスタマイズ」** → **画像**
5. **「写真を参照」** をクリック
6. USB内の壁紙フォルダを開く
7. 該当する番号の画像を選択  
   例：サイネージ01 → `signage_01.png`
8. **「適用」**

**OK判定**
- デスクトップ背景に番号が大きく表示されていればOK

---

## ⑥ ディスプレイの向き設定（縦長・必須）

### ⑥-1 注意点
ディスプレイの設置方向によっては **上下が逆／横向き** になる場合があります。  
**必ず現地で目視確認** してください。

### ⑥-2 設定手順（GUI操作）
1. デスクトップで **右クリック**
2. **「ディスプレイ設定」** をクリック
3. **「画面の向き」** を確認
4. 以下のいずれかを選択
   - **縦**
   - **縦（反対向き）**
5. 画面が正しい向きになる方を選ぶ
6. **「変更を保持する」** をクリック

**OK判定**
- 文字や動画が **正しく縦長表示** されればOK

---

## ⑦ IPアドレス固定設定（番号対応・必須）

### ⑦-1 IP割り当てルール（厳守）
- **IPアドレス範囲：** `192.168.1.201 ～ 192.168.1.220`
- **下2桁 ＝ サイネージ番号**
  - サイネージ01 → `192.168.1.201`
  - サイネージ02 → `192.168.1.202`
  - …
  - サイネージ20 → `192.168.1.220`

**重要**
- **壁紙の番号＝IPアドレスの下2桁** を必ず一致させる

### ⑦-2 設定手順（GUI操作）
1. **設定**
2. **ネットワークとインターネット**
3. **詳細ネットワーク設定**
4. **アダプターのオプションを変更する**
5. 使用中のネットワークを右クリック → **プロパティ**
6. **インターネット プロトコル バージョン4（IPv4）**
7. **プロパティ**
8. **「次のIPアドレスを使う」** を選択
9. 設定例（サイネージ01の場合）
   - IPアドレス：`192.168.1.201`
   - サブネット：`255.255.255.0`
   - ゲートウェイ：`192.168.1.1`
10. **OK** → **閉じる**

---

## ⑧ ログインパスワードを不要にする設定（自動ログイン）

### ⑧-0 これは何のための設定か？（超重要）
通常のWindowsは、

- 電源ON
- ログイン画面が表示
- ユーザー名・パスワード入力

という流れになります。

しかしサイネージでは、
**電源が入ったら何も聞かれず動いてほしい** ため、
**ログイン画面を出さず、自動でログインする設定** を行います。

**⚠ 注意（必ず読む）**
- この設定では **レジストリを変更** します
- **決められた場所・項目・値だけ** を変更します
- **指定以外のキーは変更・削除しない**
- **大文字・小文字は完全一致**
- **値の前後に空白を入れない**

### ⑧-1 管理者アカウントのパスワード設定（必須）
対象ユーザーは **SystemAV（Administrators）** です。

**設定するパスワード**
- `kanrisya`

**手順（GUI操作）**
1. Windows に **SystemAV** でログイン
2. **設定** → **アカウント** → **サインイン オプション**
3. **「パスワード」** を開く
4. **「追加」** をクリック
5. **新しいパスワード：** `kanrisya`
6. **確認用パスワード：** `kanrisya`
7. **完了**

**補足**
- 初期状態ではパスワード未設定のため、表示は **「変更」ではなく「追加」** が正しい。

### ⑧-2 レジストリエディターを開く
1. キーボードで **Windowsキー + R** を同時に押す
2. **「ファイル名を指定して実行」** という小さい画面が出る
3. 入力欄に次をそのまま入力

```
regedit
```

4. **OK** をクリック
5. 「このアプリが変更を加えることを許可しますか？」
   - **はい** をクリック

### ⑧-3 目的の場所へ移動する
左側にフォルダのような一覧が見えます。以下の順番でクリックして開いてください。

```
HKEY_LOCAL_MACHINE
 └ SOFTWARE
    └ Microsoft
       └ Windows NT
          └ CurrentVersion
             └ Winlogon
```

- 最後に **Winlogon** をクリック
- 右側にたくさんの項目が表示されます

### ⑧-4 変更・確認する項目（3項目のみ）
**この3つ以外は絶対に触らない。**

#### ① AutoAdminLogon（なければ作成）
- **種類：** 文字列値（REG_SZ）
- **値：** `1`

**手順**
1. 右側で **AutoAdminLogon** を探す
2. 見つからない場合は **右クリック → 新規 → 文字列値** で作成
3. **AutoAdminLogon** をダブルクリック
4. **「値のデータ」** を `1` に変更
5. **OK**

#### ② DefaultUserName（なければ作成）
- **種類：** 文字列値（REG_SZ）
- **値：** `SystemAV`

**手順**
1. 右側の何もないところで **右クリック**
2. **新規 → 文字列値**
3. 名前を次に変更

```
DefaultUserName
```

4. **DefaultUserName** をダブルクリック
5. **値のデータ** に `SystemAV` を入力
6. **OK**

#### ③ DefaultPassword（なければ作成）
- **種類：** 文字列値（REG_SZ）
- **値：** `kanrisya`

**手順**
1. 右側で **右クリック**
2. **新規 → 文字列値**
3. 名前を次に変更

```
DefaultPassword
```

4. **DefaultPassword** をダブルクリック
5. **値のデータ** に `kanrisya` を入力
6. **OK**

### ⑧-5 設定完了
1. レジストリエディターを閉じる
2. PCを再起動
3. **ログイン画面が出なければ成功**
4. **SystemAV に自動ログインされ、デスクトップが表示される**

### ⑧-6 失敗した場合の確認ポイント
- ログイン画面が出る場合
  - **DefaultPassword** の入力ミスが多い
- ユーザー名が違う場合
  - **DefaultUserName** の表記ミス
- それ以外
  - レジストリを再確認

### ⑧-7 本作業の完了条件（CODEX判定基準）
- 管理者アカウント **SystemAV** にパスワード `kanrisya` が設定されている
- 再起動後、自動ログインされる
- 手動操作なしで次工程（タスクスケジューラ起動）へ進める

### ⑧-8 変更しない事項（明記）
- 他ユーザー設定
- Windows Update 設定
- ファイアーウォール設定
- タスクスケジューラ設定
- `_TsuyamaSignage` フォルダ内容

---

## ⑨ 最終確認（必ずやる）

### ⑨-1 再起動
1. **Windowsマーク**
2. **電源アイコン**
3. **再起動**

### ⑨-2 確認
1. 何も触らず **1分待つ**
2. 自動で動画が **全画面表示** される
3. 出たら **成功**

---

## ⑩ 本CODEX指示の完了条件（必ず満たす）
以下すべてを満たしていることを確認する。

- タスクスケジューラが **30秒遅延** で確実に発火する
- 壁紙に **正しいサイネージ番号** が表示されている
- ディスプレイが **正しい縦向き** になっている
- **IPアドレスの下2桁** と **壁紙番号** が一致している
- 管理者アカウント設定手順の **「追加」表記** が修正済み

---

## ⑪ 変更しない事項（明記）
以下は **変更しない**。

- `_TsuyamaSignage` フォルダ構成
- Python / mpv の実行方式
- `start_signage.bat` の内容
- `auto_play.py` のロジック

---

## 自動起動の方法の違い（重要な考え方）
ここは **「なぜタスクスケジューラを使ったのか？」** を説明します。

### 方法① スタートアップフォルダにショートカットを入れる方法
**やり方**
- スタートアップ フォルダに `start_signage.bat` のショートカットを置く

**特徴**
- **ログイン後に実行** される
- **ユーザーごと** の設定
- 設定は簡単

**問題点**
- ログインに失敗すると **起動しない**
- **権限が弱い**
- エラーが起きやすい

**👉 一般PC向け**

### 方法② タスクスケジューラを使う方法（今回採用）
**やり方**
- **ログオン時に** 直接バッチを実行

**特徴**
- **ログイン前でも動く**
- **管理者権限で動かせる**
- **再現性が高い**

**強み**
- **無人運用に最適**
- **停電・再起動に強い**
- **業務用PC向け**


**👉 今回は「タスクスケジューラが正解」**

---

## 困ったときはこれだけ覚える
- 動かない → **`C:\_TsuyamaSignage` をコピーし直す**
- 触っていいのは → **`content` フォルダだけ**
- それ以外は → **触らない**
