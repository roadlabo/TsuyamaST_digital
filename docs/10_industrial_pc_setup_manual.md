# 津山駅サイネージ
# 産業用PC セットアップマニュアル【初心者向け・端的・BAT起動統一版】

## 冒頭に必ず確認すること
- 管理者ユーザー：**SystemAV**
- 管理者ログオンパスワード：**kanrisya**
- この手順は**上から順にそのまま実行する。**
- **ファイル名・フォルダ名は絶対に変更しない。**

## **【重要】フォルダ共有方式について（必ず読む）**
このシステムでは、**フォルダ共有は必ず1か所のみ**とする。

- 共有するフォルダ：  
  `C:\_TsuyamaSignage`
- 共有名：  
  `_TsuyamaSignage`

以下のような共有は **すべて誤り**であり、システムは正常に動作しない。

- app フォルダだけを共有する
- config / logs / content を個別に共有する
- 複数の共有を同時に設定する

**必ず `C:\_TsuyamaSignage` を丸ごと1本で共有すること。**

---

## 作業全体の流れ（この順番で固定）
1. ディスプレイの向き（縦）を確定
2. 壁紙（サイネージ番号）を設定
3. USBから C:\_TsuyamaSignage をコピー
4. 画面が消えない設定（スリープ無効）
5. WindowsファイアーウォールをOFF
6. フォルダ共有（C:\_TsuyamaSignage を丸ごと1本で共有）
7. IPアドレス固定
8. 自動ログイン設定（SystemAV / kanrisya）
9. タスクスケジューラ設定（本番＝BAT起動）
10. 再起動して自動再生を確認

---

## 変更しない事項（必ず守る）
- C:\_TsuyamaSignage フォルダ構成
- フォルダ共有は **C:\_TsuyamaSignage のみ**
- config / logs / content を個別に共有しない
- 共有名は **_TsuyamaSignage 固定**
- BATファイル名（start_auto_play.bat / start_pc_agent.bat）

---

## 1. ディスプレイの向き（縦）を確定
**操作不能防止のため、最初に実施する。**

1. デスクトップの何もないところで右クリック
2. 表示されたメニューから「ディスプレイ設定」をクリック
3. 設定画面の「画面の向き」をクリック
4. 表示される選択肢から **「縦」または「縦（反対向き）」** を選ぶ
5. 画面が切り替わったら「変更を保持する」をクリック

**確認方法**
- 設定画面の「画面の向き」が **「縦」または「縦（反対向き）」** と表示されていることを確認する。

---

## 2. 壁紙（サイネージ番号）を設定
**サイネージ番号＝IPアドレス下2桁。必ず一致させる。**

1. デスクトップの何もないところで右クリック
2. 表示されたメニューから「個人用設定」をクリック
3. 左側の「背景」をクリック
4. 「写真を参照」をクリック
5. USB内の壁紙フォルダから番号画像をクリックして選ぶ
   - 例：01番 → `signage_01.png`

**確認方法**
- デスクトップ背景に、選んだ番号が大きく表示されていることを確認する。

---

## 3. USBから C:\_TsuyamaSignage をコピー
1. USBメモリを挿す
2. エクスプローラーを開く
3. 左側の「このPC」からUSBドライブをクリック
4. USB内の **_TsuyamaSignage** を右クリック
5. 表示されたメニューから「コピー」をクリック
6. 左側の「Windows (C:)」をクリック
7. 右側の空白部分で右クリック
8. 表示されたメニューから「貼り付け」をクリック

**注意**
- フォルダ名は変更しない
- Cドライブ直下に置く

**確認方法**
- エクスプローラーで `C:\_TsuyamaSignage` が表示され、開けることを確認する。

---

## 4. 画面が消えない設定（スリープ無効）
1. スタートボタンをクリック
2. 表示された「設定」をクリック
3. 「システム」をクリック
4. 「電源とバッテリー」をクリック
5. 「画面とスリープ」をクリック
6. 表示される全項目を **「なし」** に変更する

**確認方法**
- 「画面とスリープ」のすべての項目が **「なし」** になっていることを確認する。

---

## 5. WindowsファイアーウォールをOFF
1. スタートボタンをクリック
2. 表示された「Windows セキュリティ」をクリック
3. 「ファイアーウォールとネットワーク保護」をクリック
4. 「ドメインネットワーク」をクリックし、「ファイアーウォール」を「オフ」に切り替える
5. 戻るボタンで前の画面に戻る
6. 「プライベートネットワーク」をクリックし、「ファイアーウォール」を「オフ」に切り替える
7. 戻るボタンで前の画面に戻る
8. 「パブリックネットワーク」をクリックし、「ファイアーウォール」を「オフ」に切り替える

**確認方法**
- 「ファイアーウォールとネットワーク保護」の3項目が **「オフ」** と表示されていることを確認する。

---

## 6. フォルダ共有（C:\_TsuyamaSignage を丸ごと1本で共有）
この作業は **遠隔操作・再起動・コンテンツ更新のために必須**である。  
設定を間違えると、管理PCから操作できなくなる。

### 6-1 共有するフォルダを確認
1. エクスプローラーを開く
2. 左側の「Windows (C:)」をクリック
3. `C:\_TsuyamaSignage` フォルダが表示されることを確認する

※ このフォルダが無い場合は、STEP3（USBからコピー）に戻る。

**確認方法**
- `C:\_TsuyamaSignage` フォルダが一覧に表示され、開けることを確認する。

---

### 6-2 既存の誤った共有をすべて解除する（重要）
**以下のフォルダが共有されている場合は、必ず解除する。**

- `C:\_TsuyamaSignage\app\config`
- `C:\_TsuyamaSignage\logs`
- `C:\_TsuyamaSignage\content`

解除手順（各フォルダで同じ操作）：
1. 対象フォルダを右クリック
2. 表示されたメニューから「プロパティ」をクリック
3. 「共有」タブをクリック
4. 「共有の解除」または「共有を停止」をクリック
5. 「OK」をクリック

※ 個別共有が1つでも残っていると、誤動作の原因になる。

**確認方法**
- 上記3つのフォルダで「共有の解除」または「共有を停止」を実行したことを確認する。

---

### 6-3 C:\_TsuyamaSignage を共有する
1. `C:\_TsuyamaSignage` を右クリック
2. 表示されたメニューから「その他のオプションを表示」をクリック
3. 「アクセスを許可する」をクリック
4. 表示されたサブメニューで「特定のユーザー」をクリック
5. 共有設定の画面で「Everyone」をクリック
6. 「追加」をクリック
7. 「権限レベル」をクリックし、表示された一覧から「読み取り/書き込み」を選ぶ
8. 「共有」をクリック
9. 「完了」をクリック

**確認方法**
- 共有設定画面に「Everyone」が表示され、権限レベルが「読み取り/書き込み」になっていることを確認する。

---

### 6-4 共有名を確認する（重要）
1. `C:\_TsuyamaSignage` を右クリック
2. 表示されたメニューから「プロパティ」をクリック
3. 「共有」タブをクリック
4. 「共有名」が `_TsuyamaSignage` になっていることを確認する

※ 違う名前の場合は、必ず `_TsuyamaSignage` に変更する。

**確認方法**
- 「共有」タブ内の「共有名」が **`_TsuyamaSignage`** と表示されていることを確認する。

---

### 6-5 共有確認（必ず実施）
1. エクスプローラーのアドレスバーをクリック
2. 次の文字を入力して Enter を押す

```
\\localhost\_TsuyamaSignage
```

3. 画面に表示されたフォルダ一覧を確認する

**確認方法**
- 以下のフォルダが表示されることを確認する
  - app
  - content
  - logs
  - runtime
- これらが見えれば共有設定は成功。

---

## 7. IPアドレス固定
**壁紙番号と必ず一致。**

- 範囲：`192.168.1.201 ～ 192.168.1.220`
- 下2桁＝サイネージ番号
- サブネットマスク：`255.255.255.0`

手順：
1. スタートボタンをクリック
2. 表示された「設定」をクリック
3. 「ネットワークとインターネット」をクリック
4. 「イーサネット」をクリック
5. 「IP割り当て」の右側にある「編集」をクリック
6. 表示された画面で「手動」を選び、「IPv4」を「オン」にする
7. IPアドレスとサブネットマスクを入力する
8. 「保存」をクリック

**確認方法**
- `Windows + R` を押し、「cmd」と入力して「OK」をクリック
- コマンドプロンプトで `ipconfig` と入力して Enter を押し、表示されたIPアドレスが設定値と一致していることを確認する。

---

## 8. 自動ログイン設定（SystemAV / kanrisya）
**管理者ユーザー：SystemAV**  
**管理者ログオンパスワード：kanrisya**

### 8-1 管理者パスワード設定
1. SystemAVでログイン
2. スタートボタンをクリック
3. 表示された「設定」をクリック
4. 「アカウント」をクリック
5. 「サインイン オプション」をクリック
6. 「パスワード」の欄にある「追加」をクリック
7. 新しいパスワードに `kanrisya` を入力
8. 画面の指示に従って完了する

**確認方法**
- サインイン オプション画面の「パスワード」に「変更」ボタンが表示されていることを確認する。

### 8-2 自動ログイン（レジストリ）
1. `Windows + R` を押す
2. 表示された「ファイル名を指定して実行」に `regedit` と入力
3. 「OK」をクリック
4. レジストリエディターで次の場所を開く

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon
```

5. 右側の一覧で以下3つの文字列値を設定する
   - `AutoAdminLogon` = `1`
   - `DefaultUserName` = `SystemAV`
   - `DefaultPassword` = `kanrisya`
6. レジストリエディターを閉じる
7. PCを再起動する

**確認方法**
- 再起動後にログイン画面が表示されず、自動でSystemAVが起動することを確認する。

---

## 9. タスクスケジューラ設定（本番＝BAT起動）
**方針（必ず守る）**  
タスクスケジューラが起動するのは **.bat と .exe のみ。**  
Python のことは気にしなくてよい。

### 9-1 作成するタスクは3つだけ
| タスク名 | 起動するもの | トリガー | 遅延 |
|---|---|---|---|
| Tsuyama HWiNFO Auto Start | HWiNFO64.exe | 起動時 | 30秒 |
| Tsuyama PC Agent Auto Start | start_pc_agent.bat | 起動時 | 2分 |
| Tsuyama Auto Play Start | start_auto_play.bat | ログオン時（SystemAV） | 30秒 |

### 9-2 共通ルール
- **必ず .bat / .exe を指定する**
- **開始（オプション）は同フォルダを指定**
- タスク作成時にパスワードを求められたら **kanrisya** を入力

### 9-3 各タスクの指定内容

#### A. Tsuyama HWiNFO Auto Start
- **プログラム/スクリプト：**
  `C:\_TsuyamaSignage\runtime\hwinfo\HWiNFO64.exe`
- **開始（オプション）：**
  `C:\_TsuyamaSignage\runtime\hwinfo`
- **トリガー：** 起動時
- **遅延：** 30秒

#### B. Tsuyama PC Agent Auto Start
- **プログラム/スクリプト：**
  `C:\_TsuyamaSignage\app\signagePC\start_pc_agent.bat`
- **開始（オプション）：**
  `C:\_TsuyamaSignage\app\signagePC`
- **トリガー：** 起動時
- **遅延：** 2分

#### C. Tsuyama Auto Play Start
- **プログラム/スクリプト：**
  `C:\_TsuyamaSignage\app\signagePC\start_auto_play.bat`
- **開始（オプション）：**
  `C:\_TsuyamaSignage\app\signagePC`
- **トリガー：** ログオン時（SystemAV）
- **遅延：** 30秒

**BATファイル名は最終固定**
- `start_auto_play.bat`
- `start_pc_agent.bat`

**確認方法**
- タスクスケジューラの一覧に上記3つのタスク名が表示されることを確認する。
- 各タスクの「操作」タブに、指定したプログラム/スクリプトのパスが表示されていることを確認する。

---

## 10. 再起動して自動再生を確認
1. スタートボタンをクリック
2. 電源マークをクリック
3. 「再起動」をクリック
4. 再起動後は何も触らず待つ

**確認方法**
- 自動で再生が始まることを確認する。

---

## よくある失敗（必ず確認）
- config / logs / content を個別に共有してしまう → ❌
- app フォルダだけを共有する → ❌
- 共有名を変更してしまう → ❌
- フォルダ名を変更する → ❌

**共有は必ず「C:\_TsuyamaSignage を丸ごと1本」だけ。**

---

## 困ったときはこれだけ
- 動かない → **C:\_TsuyamaSignage をコピーし直す**
- 触っていいのは → **content フォルダだけ**
- それ以外は → **触らない**
